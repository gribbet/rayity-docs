{"version":3,"sources":["webpack:///webpack/bootstrap e83120b03b2a3b42fc5a","webpack:///../rayity/src/expression.ts","webpack:///../rayity/src/material.ts","webpack:///../rayity/src/camera.ts","webpack:///../rayity/src/options.ts","webpack:///../rayity/src/shape.ts","webpack:///../rayity/src/index.ts","webpack:///../rayity/src/build.ts","webpack:///../rayity/src/model.ts","webpack:///../rayity/src/renderer.ts","webpack:///../rayity/src/scene.ts","webpack:///../rayity/src/viewer.ts","webpack:///./index.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;ACxDA,IAAI,OAAO,GAAiB,EAAE,CAAC;AAE/B;;;GAGG;AACH,oBAA2B,IAAU;IACpC,IAAI,EAAE,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC;IAC1B,IAAI,IAAI,GAAG;QACV,EAAE,EAAE,EAAE;QACN,IAAI,EAAE,IAAI;QACV,YAAY,EAAE,OAAO;QACrB,QAAQ,EAAE;YACT,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gBAChC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpB,MAAM,CAAC,EAAE,CAAC;QACX,CAAC;KACD,CAAC;IACF,OAAO,GAAG,EAAE,CAAC;IACb,MAAM,CAAC,IAAI,CAAC;AACb,CAAC;AAdD,gCAcC;AAED,oBAAoB,IAAU;IAC7B,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;AACtC,CAAC;AAED,cAAc,CAAS;IACtB,IAAI,IAAI,GAAG,IAAI,CAAC;IAEhB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE;QAChC,IAAI,GAAG,CAAC,IAAI,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;IAEtC,MAAM,CAAC,IAAI,KAAK,CAAC,CAAC;AACnB,CAAC;AAED,eACC,CAAa,EACb,CAAa,EACb,CAAa;IAFb,yBAAa;IACb,yBAAa;IACb,yBAAa;IACb,MAAM,CAAC,UAAU,CAAC,UAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC,UAAK,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC,UAAK,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC,MAAG,CAAC,CAAC;AAC7F,CAAC;AALD,sBAKC;AAED,kBAAyB,IAAY;IACpC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AACzB,CAAC;AAFD,4BAEC;AAED,gBAAuB,CAAa;IACnC,MAAM,CAAC,UAAU,CAAC,mBAAiB,CAAC,6DAA0D,CAAC,CAAC;AACjG,CAAC;AAFD,wBAEC;AAED,iBAAwB,CAAa;IACpC,MAAM,CAAC,UAAU,CAAC,aAAW,CAAC,YAAO,CAAC,aAAQ,CAAC,QAAK,CAAC,CAAC;AACvD,CAAC;AAFD,0BAEC;;;;;;;;;;AC5DD,0CAA6D;AAW7D,kBAAyB,MAOxB;IACA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;QACpB,aAAa,EAAE,kBAAK,CAAC,CAAC,CAAC;QACvB,UAAU,EAAE,kBAAK,CAAC,CAAC,CAAC;QACpB,UAAU,EAAE,kBAAK,CAAC,CAAC,CAAC;QACpB,OAAO,EAAE,kBAAK,CAAC,IAAI,CAAC;QACpB,KAAK,EAAE,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,UAAU,EAAE,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;KAC1B,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;AAClB,CAAC;AAhBD,4BAgBC;AAED,mBAA0B,OAKzB;IACA,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;IACxB,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACpD,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC5C,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,kBAAK,CAAC,CAAC,CAAC,CAAC;IACxC,IAAI,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,kBAAK,CAAC,CAAC,CAAC,CAAC;IAC1C,MAAM,CAAC,QAAQ,CAAC;QACf,KAAK,EAAE,kBAAK,CAAC,CAAC,CAAC;QACf,UAAU,EAAE,uBAAU,CAClB,KAAK,WAAM,MAAM,6CAAwC,SAAS,8BAAyB,MAAM,oBAAe,OAAS,CAAC;KAC9H,CAAC,CAAC;AACJ,CAAC;AAhBD,8BAgBC;;;;;;;;;;AC7CD,0CAA6D;AAU7D,gBAAuB,MAMtB;IACA,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IACtB,MAAM,CAAC;QACN,GAAG,EAAE,MAAM,CAAC,GAAG,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAClC,MAAM,EAAE,MAAM,CAAC,MAAM,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACvC,EAAE,EAAE,MAAM,CAAC,EAAE,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B,WAAW,EAAE,MAAM,CAAC,WAAW,IAAI,kBAAK,CAAC,EAAE,GAAG,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC;QAC9D,QAAQ,EAAE,MAAM,CAAC,QAAQ,IAAI,kBAAK,CAAC,GAAG,CAAC;KACvC,CAAC;AACH,CAAC;AAfD,wBAeC;AAED,eAAsB,MAOrB;IACA,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IACtB,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAChD,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,kBAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC7C,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,IAAI,kBAAK,CAAC,CAAC,CAAC,CAAC;IAC9C,MAAM,CAAC,MAAM,CAAC;QACb,MAAM,EAAE,MAAM,CAAC,MAAM;QACrB,GAAG,EAAE,uBAAU,CACX,MAAM,CAAC,MAAM,WAAM,MAAM,CAAC,QAAQ,gCAA2B,MAAM,CAAC,MAAM,gDAA6C,CAAC;QAC5H,EAAE,EAAE,MAAM,CAAC,EAAE;QACb,WAAW,EAAE,MAAM,CAAC,WAAW;QAC/B,QAAQ,EAAE,MAAM,CAAC,QAAQ;KACzB,CAAC,CAAC;AACJ,CAAC;AApBD,sBAoBC;;;;;;;;;;ACpCD,iBAAwB,MASvB;IACG,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;IACtB,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;QACjB,KAAK,EAAE,GAAG;QACV,MAAM,EAAE,GAAG;QACX,OAAO,EAAE,IAAI;QACb,KAAK,EAAE,GAAG;QACV,OAAO,EAAE,CAAC;QACV,UAAU,EAAE,CAAC;QACb,MAAM,EAAE,GAAG;QACX,YAAY,EAAE,KAAK;KACtB,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;AACrB,CAAC;AArBD,0BAqBC;;;;;;;;;;AChCD,0CAA8E;AAM9E,eAAe,IAA0C;IACxD,MAAM,CAAC;QACN,IAAI,EAAE,IAAI;KACV,CAAC;AACH,CAAC;AAED;IACC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,WAAW,CAAC;IAAvB,CAAuB,CAAC,CAAC;AAC3B,CAAC;AAHD,oBAGC;AAED;IACC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,YAAY,CAAC;IAAxB,CAAwB,CAAC,CAAC;AAC5B,CAAC;AAHD,oBAGC;AAED;IACC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,YAAU,CAAC,YAAS,CAAC;IAAhC,CAAgC,CAAC,CAAC;AACpC,CAAC;AAHD,wBAGC;AAED,eAAsB,MAAkB,EAAE,MAAkB;IAC3D,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,SAAO,CAAC,UAAK,MAAM,YAAO,MAAM,OAAI,CAAC;IAAhD,CAAgD,CAAC,CAAC;AACpD,CAAC;AAHD,sBAGC;AAED,mBAAmB,OAAqB;IACvC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;QAC1B,mBAAY,CAAC,CAAC,EACb,KAAK,CAAC,CAAC,EAAE,kBAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IADvB,CACuB,EACvB,IAAI,EAAE,CAAC,CAAC;AACV,CAAC;AAED;IACC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACrB,MAAM,CAAC,SAAS,CAAC;QAChB,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAC7B,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;KAC3B,CAAC,CAAC;AACJ,CAAC;AARD,kCAQC;AAED;IACC,MAAM,CAAC,SAAS,CAAC;QAChB,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACd,kBAAK,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACf,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACd,kBAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;QACf,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACd,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;KACf,CAAC,CAAC;AACJ,CAAC;AATD,oBASC;AAED;IACC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACrB,MAAM,CAAC,SAAS,CAAC;QAChB,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC1B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAC3B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAC5B,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC3B,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAC5B,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC5B,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;KAC7B,CAAC,CAAC;AACJ,CAAC;AAZD,gCAYC;AAED;IACC,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IACnC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC;IACjC,MAAM,CAAC,SAAS,CAAC;QAChB,kBAAK,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QACxB,kBAAK,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QACxB,kBAAK,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;QACxB,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QAC1B,kBAAK,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QAC1B,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC;QACzB,kBAAK,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC;KAC1B,CAAC,CAAC;AACJ,CAAC;AAjBD,oCAiBC;AAID;IACC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,YAAU,CAAC,eAAY,CAAC;IAAnC,CAAmC,CAAC,CAAC;AACvC,CAAC;AAHD,4BAGC;AAED;IACC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAC,wBAAsB,CAAC,oBAAe,CAAC,eAAY,CAAC;IAA/D,CAA+D,CAAC,CAAC;AACnE,CAAC;AAHD,sBAGC;AAED,mBAA0B,CAAa,EAAE,CAAQ;IAChD,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,QAAC,CAAC,IAAI,CAAC,uBAAU,CAAI,CAAC,WAAM,CAAG,CAAC,CAAC;IAAjC,CAAiC,CAAC,CAAC;AACrC,CAAC;AAHD,8BAGC;AAED,eAAsB,CAAa,EAAE,CAAQ;IAC5C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAI,CAAC,WAAM,CAAC,OAAI,CAAC,CAAC,CAAC;QAC5C,MAAM,CAAC,uBAAU,CAAI,CAAC,WAAM,CAAC,OAAI,CAAC,CAAC;IACpC,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,sBAKC;AAED,aAAoB,CAAQ;IAC3B,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,QAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,SAAO,CAAC,WAAQ,CAAC,CAAC;IAApC,CAAoC,CAAC,CAAC;AACxC,CAAC;AAHD,kBAGC;AAED,iBAAwB,CAAa,EAAE,CAAQ;IAC9C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,8BAAU,CAAI,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAI,CAAC,WAAM,CAAG,CAAC,CAAC,WAAM,oBAAO,CAAC,CAAC,CAAG,CAAC;IAAlE,CAAkE,CAAC,CAAC;AACtE,CAAC;AAHD,0BAGC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,QAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,SAAO,CAAC,WAAM,CAAC,gBAAW,CAAC,YAAO,CAAC,WAAQ,CAAC,CAAC;IAA/D,CAA+D,CAAC,CAAC;AACnE,CAAC;AAHD,wBAGC;AAED,eAAsB,CAAQ,EAAE,CAAQ;IACvC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,MAAM,CAAC,uBAAU,CAAC,SAAO,EAAE,UAAK,EAAE,MAAG,CAAC;IACvC,CAAC,CAAC,CAAC;AACJ,CAAC;AAND,sBAMC;AAED,sBAA6B,CAAQ,EAAE,CAAQ;IAC9C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,MAAM,CAAC,uBAAU,CAAC,SAAO,EAAE,UAAK,EAAE,MAAG,CAAC;IACvC,CAAC,CAAC,CAAC;AACJ,CAAC;AAND,oCAMC;AAED,oBAA2B,CAAQ,EAAE,CAAQ;IAC5C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,MAAM,CAAC,uBAAU,CAAC,SAAO,EAAE,WAAM,EAAE,MAAG,CAAC;IACxC,CAAC,CAAC,CAAC;AACJ,CAAC;AAND,gCAMC;AAED,eAAsB,CAAa,EAAE,CAAQ,EAAE,CAAQ;IACtD,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,CAAC,GAAG,uBAAU,CAAC,wBAAsB,EAAE,WAAM,EAAE,YAAO,CAAC,gBAAa,CAAC,CAAC;QAC1E,MAAM,CAAC,uBAAU,CAAC,SAAO,EAAE,UAAK,EAAE,UAAK,CAAC,YAAO,CAAC,WAAM,CAAC,kBAAa,CAAC,MAAG,CAAC,CAAC;IAC3E,CAAC,CAAC,CAAC;AACJ,CAAC;AAPD,sBAOC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnB,MAAM,CAAC,uBAAU,CAAI,EAAE,WAAM,CAAC,OAAI,CAAC;IACpC,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,wBAKC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,cAAO,CAAC,uBAAU,CAAC,UAAQ,CAAC,aAAQ,CAAC,QAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IAAvD,CAAuD,CAAC,CAAC;AAC3D,CAAC;AAHD,wBAGC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,cAAO,CAAC,uBAAU,CAAC,UAAQ,CAAC,aAAQ,CAAC,QAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IAAvD,CAAuD,CAAC,CAAC;AAC3D,CAAC;AAHD,wBAGC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,cAAO,CAAC,uBAAU,CAAC,UAAQ,CAAC,aAAQ,CAAC,QAAK,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IAAvD,CAAuD,CAAC,CAAC;AAC3D,CAAC;AAHD,wBAGC;AAED,iBAAwB,CAAa,EAAE,CAAQ;IAC9C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,uBAAU,CAAC,SAAO,CAAC,iBAAY,CAAC,WAAQ,CAAC,CAAC;QAClD,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,sBAAoB,CAAC,YAAO,CAAC,gBAAW,CAAC,YAAO,CAAC,cAAS,CAAG,CAAC,CAAC;IACzF,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,0BAKC;AAED,iBAAwB,CAAa,EAAE,CAAQ;IAC9C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,uBAAU,CAAC,SAAO,CAAC,iBAAY,CAAC,WAAQ,CAAC,CAAC;QAClD,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,UAAQ,CAAC,gBAAW,CAAC,qBAAgB,CAAC,eAAU,CAAC,cAAS,CAAG,CAAC,CAAC;IACzF,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,0BAKC;AAED,iBAAwB,CAAa,EAAE,CAAQ;IAC9C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,uBAAU,CAAC,SAAO,CAAC,iBAAY,CAAC,WAAQ,CAAC,CAAC;QAClD,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,UAAQ,CAAC,YAAO,CAAC,gBAAW,CAAC,YAAO,CAAC,0BAAqB,CAAG,CAAC,CAAC;IACzF,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,0BAKC;AAED,gBAAuB,IAAgB,EAAE,CAAa,EAAE,CAAQ;IAC/D,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,uBAAU,CAAC,eAAa,IAAI,MAAG,CAAC,CAAC;QACzC,IAAI,CAAC,GAAG,uBAAU,CAAC,SAAO,CAAC,iBAAY,CAAC,WAAQ,CAAC,CAAC;QAClD,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAC,kBACtB,CAAC,aAAQ,CAAC,aAAQ,CAAC,oBAAe,CAAC,qBACnC,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,aAAQ,CAAC,aAAQ,CAAC,oBAAe,CAAC,oBACnC,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,aAAQ,CAAC,oBAAe,CAAC,cAAS,CAAC,aAAQ,CAAC,mBAC7C,CAAC,cAAS,CAAC,aAAQ,CAAC,oBAAe,CAAC,eAAU,CAAG,CAAC,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;AACJ,CAAC;AAfD,wBAeC;AAED,eAAsB,CAAQ;IAC7B,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,CAAC,GAAG,uBAAU,CAAC,cAAc,CAAC,CAAC;QACnC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAU,CAAI,CAAC,YAAO,CAAC,iBAAY,CAAC,aAAQ,CAAC,QAAK,CAAC,CAAC,CAAC;IACpE,CAAC,CAAC,CAAC;AACJ,CAAC;AALD,sBAKC;AAED,gBAAuB,CAAa,EAAE,CAAQ;IAC7C,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,QAAC,CAAC,IAAI,CAAC,uBAAU,CAAI,CAAC,8BAAyB,CAAC,UAAK,CAAC,aAAQ,CAAG,CAAC,CAAC;IAAnE,CAAmE,CAAC,CAAC;AACvE,CAAC;AAHD,wBAGC;AAED,mBAA0B,UAAsB,EAAE,MAAkB;IACnE,MAAM,CAAC,MAAM,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAC3B,MAAM,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACpB,MAAM,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACpB,SAAS,CAAC,uBAAU,CAAC,YAAU,UAAU,WAAM,MAAM,MAAG,CAAC,EACxD,GAAG,CACF,KAAK,CAAC,MAAM,EACX,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACtB,CAAC;AARD,8BAQC;AAED,oBAA2B,UAAsB,EAAE,CAAwB;IAAhD,2CAAsB;IAAE,wBAAW,WAAW,EAAE;IAC1E,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACrB,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC;SACtB,IAAI,CAAC,CAAC,CAAC;SACP,MAAM,CAAC,UAAC,KAAK,EAAE,CAAC;QAChB,aAAM,CAAC,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,EAC5B,MAAM,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAC5B,MAAM,CAAC,kBAAK,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAC5B,KAAK,CAAC,kBAAK,CAAC,GAAG,CAAC,EACf,SAAS,CAAC,kBAAK,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAClC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IALf,CAKe,EAAE,CAAC,CAAC,CAAC;AACvB,CAAC;AAXD,gCAWC;AAED,cAAqB,UAAsB;IAAtB,2CAAsB;IAC1C,IAAI,MAAM,GAAG,IAAI,CAAC;IAClB,IAAI,MAAM,GAAG,GAAG,CAAC;IACjB,IAAI,KAAK,GAAG,GAAG,CAAC;IAChB,IAAI,KAAK,GAAG,EAAE,CAAC;IAEf,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC;SACtB,IAAI,CAAC,CAAC,CAAC;SACP,MAAM,CAAC,UAAC,KAAK,EAAE,CAAC,EAAE,CAAC;QACnB,YAAK,CACJ,kBAAK,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,EACjC,KAAK,EACL,MAAM,CAAC,kBAAK,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAClD,MAAM,CAAC,kBAAK,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EACnD,SAAS,CACR,kBAAK,CACJ,MAAM,GAAG,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC,EACrD,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,EAC/D,CAAC,CAAC,EACH,KAAK,CAAC,kBAAK,CAAC,MAAM,CAAC,EAClB,OAAO,CAAC,kBAAK,CAAC,GAAG,CAAC,EACjB,OAAO,CAAC,kBAAK,CAAC,KAAK,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC,EACnC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAbnB,CAamB,EACpB,SAAS,CAAC,kBAAK,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC,EAAE,kBAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5D,CAAC;AAxBD,oBAwBC;AAED,kBACC,CAAa,EACb,CAA+B,EAC/B,MAAgC;IAAhC,kCAAqB,kBAAK,CAAC,IAAI,CAAC;IAChC,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,IAAI,MAAM,GAAG,uBAAU,CAAI,CAAC,WAAM,CAAC,WAAQ,CAAC,CAAC;QAC7C,IAAI,KAAK,GAAG,uBAAU,CAAC,WAAS,MAAM,WAAM,CAAC,MAAG,CAAC,CAAC;QAClD,IAAI,MAAM,GAAG,uBAAU,CAAI,KAAK,WAAM,CAAG,CAAC,CAAC;QAC3C,IAAI,KAAK,GAAG,uBAAU,CAAI,CAAC,WAAM,MAAQ,CAAC,CAAC;QAC3C,IAAI,IAAI,GAAG,KAAK,CAAC,WAAC;YACjB,IAAI,CAAC,GAAG,uBAAU,CAAI,MAAM,WAAM,CAAC,qBAAgB,CAAC,MAAG,CAAC,CAAC;YACzD,MAAM,CAAC,uBAAU,CAAC,aAAW,CAAC,YAAO,CAAC,aAAQ,CAAC,QAAK,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;aAC1B,IAAI,CAAC,KAAK,CAAC,CAAC;IACf,CAAC,CAAC,CAAC;AACJ,CAAC;AAhBD,4BAgBC;AAED,gBAAuB,CAAa,EAAE,MAAe;IACpD,MAAM,CAAC,KAAK,CAAC,WAAC;QACb,MAAM,CAAC,uBAAU,CAAC,MAAM;aACtB,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAT,CAAS,CAAC;aACnB,MAAM,CAAC,UAAC,IAAI,EAAE,CAAC,EAAE,CAAC;YAClB,WAAI,IAAM,CAAC,aAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAM,CAAC,QAAK;QAAvE,CAAuE,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC,CAAC;IAC7F,CAAC,CAAC,CAAC;AACJ,CAAC;AAPD,wBAOC;AAED;IACC,IAAI,IAAI,GAAG,YAAY,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,KAAK,CAC1C,SAAS,CAAC,kBAAK,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,EAAE,CAAC,EACtC,SAAS,CAAC,kBAAK,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,EAC5B,OAAO,CAAC,kBAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,EACzB,KAAK,EAAE,CAAC,CAAC,CAAC,EACZ,SAAS,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,EAC7B,OAAO,CAAC,kBAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,EACzB,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACf,MAAM,CAAC,QAAQ,CAAC,kBAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,eAAK;QACpC,aAAM,CAAC,mBAAM,CAAC,KAAK,CAAC,EAAE;YACrB,IAAI;YACJ,OAAO,CAAC,kBAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC;YACjC,OAAO,CAAC,kBAAK,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC;YAC7B,OAAO,CAAC,kBAAK,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC;SACrC,CAAC;IALF,CAKE,CAAC,CAAC;AACN,CAAC;AAhBD,0BAgBC;;;;;;;;;;;;;ACzUD,iCAA6B;AAC7B,iCAAwB;AACxB,iCAA2B;AAC3B,iCAAwB;AACxB,iCAAwB;AACxB,kCAAyB;AACzB,iCAAyB;AACzB,iCAA0B;;;;;;;;;;ACP1B,0CAAsE;AAKtE,yBAAyB,UAAsB;IAC9C,MAAM,CAAC,gBAAgB,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;AACvC,CAAC;AAED,0BAA0B,WAAyB;IAClD,MAAM,CAAC,cAAc,CAAC,WAAW,CAAC;SAChC,GAAG,CAAC,oBAAU,IAAI,mBAAS,UAAU,gBAAW,UAAU,CAAC,IAAI,OAAI,EAAjD,CAAiD,CAAC;SACpE,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,IAAI,GAAG,CAAC,EAAZ,CAAY,EAAE,EAAE,CAAC,CAAC;AACtC,CAAC;AAED,sBAAsB,UAAsB;IAC3C,MAAM,CAAC,iBAAiB,CACvB,cAAc,CAAC,UAAU,CAAC,YAAY,CAAC;SACrC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;AACxB,CAAC;AAED,wBAAwB,WAAyB;IAChD,MAAM,CAAC,iBAAiB,CACvB,WAAW;SACT,GAAG,CAAC,WAAC,IAAI,mBAAY,CAAC,CAAC,CAAC,EAAf,CAAe,CAAC;SACzB,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAX,CAAW,EAAE,EAAE,CAAC,CAAC,CAAC;AACvC,CAAC;AAED,2BAA2B,WAAyB;IACnD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;QAC9B,kBAAW,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,EAAb,CAAa,CAAC,KAAK,CAAC;IAA/C,CAA+C,CAAC,CAAC;AACnD,CAAC;AAED,oBACC,KAAY,EACZ,OAEC;IACD,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,qBAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;IAC/C,IAAI,IAAI,GAAG,yBAEI,KAAK,CAAC,EAAE,sBACrB,eAAe,CAAC,QAAQ,CAAC,mBAClB,QAAQ,mCAGC,KAAK,CAAC,EAAE,qDAExB,gBAAgB,CAAC;QACjB,KAAK,CAAC,QAAQ,CAAC,aAAa;QAC5B,KAAK,CAAC,QAAQ,CAAC,UAAU;QACzB,KAAK,CAAC,QAAQ,CAAC,UAAU;QACzB,KAAK,CAAC,QAAQ,CAAC,OAAO;QACtB,KAAK,CAAC,QAAQ,CAAC,KAAK;QACpB,KAAK,CAAC,QAAQ,CAAC,UAAU;KAAC,CAAC,8BACT,KAAK,CAAC,QAAQ,CAAC,aAAa,8BAC/B,KAAK,CAAC,QAAQ,CAAC,UAAU,8BACzB,KAAK,CAAC,QAAQ,CAAC,UAAU,2BAC5B,KAAK,CAAC,QAAQ,CAAC,OAAO,yBACxB,KAAK,CAAC,QAAQ,CAAC,KAAK,4BACf,KAAK,CAAC,QAAQ,CAAC,UAAU,sBAEzC,CAAC;IAEF,EAAE,CAAC,CAAC,OAAO,CAAC,YAAY,CAAC;QACxB,IAAI,IAAI,oBAEG,KAAK,CAAC,EAAE,gOAKA,KAAK,CAAC,EAAE,oDAEZ,KAAK,CAAC,EAAE,oDACR,KAAK,CAAC,EAAE,mDACR,KAAK,CAAC,EAAE,mDACR,KAAK,CAAC,EAAE,gCACvB,CAAC;IAEF,IAAI;QACH,IAAI,IAAI,oBAEG,KAAK,CAAC,EAAE,0DAET,KAAK,CAAC,EAAE,iDACR,KAAK,CAAC,EAAE,gDACR,KAAK,CAAC,EAAE,iDACR,KAAK,CAAC,EAAE,gDACR,KAAK,CAAC,EAAE,iDACR,KAAK,CAAC,EAAE,oCAClB,CAAC;IAEF,MAAM,CAAC,IAAI,CAAC;AACb,CAAC;AAED,oBACC,KAAY,EACZ,OAEC;IACD,MAAM,CAAC,KAAK,CAAC,MAAM;SACjB,GAAG,CAAC,WAAC,IAAI,iBAAU,CAAC,CAAC,EAAE,OAAO,CAAC,EAAtB,CAAsB,CAAC;SAChC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,CAAC,EAAL,CAAK,EAAE,EAAE,CAAC,GAAG,oJAOF;QAE7B,KAAK,CAAC,MAAM;aACV,GAAG,CAAC,UAAC,KAAK,EAAE,CAAC,IAAK,2CAEI,KAAK,CAAC,EAAE,mHAGb,KAAK,CAAC,EAAE,WAC1B,EANmB,CAMnB,CAAC;aACA,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,CAAC,EAAL,CAAK,EAAE,EAAE,CAAC,GAAG,iFAKgB;QAEhD,KAAK,CAAC,MAAM;aACV,GAAG,CAAC,UAAC,KAAK,EAAE,CAAC,IAAK,kCAEL,KAAK,CAAC,EAAE,4BACR,KAAK,CAAC,EAAE,gBAAa,EAHhB,CAGgB,CAAC;aACnC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,CAAC,EAAL,CAAK,EAAE,EAAE,CAAC,GAAG,0HAKmD;QAEnF,KAAK,CAAC,MAAM;aACV,GAAG,CAAC,UAAC,KAAK,EAAE,CAAC,IAAK,kCAEL,KAAK,CAAC,EAAE,8BACN,KAAK,CAAC,EAAE,mCAAgC,EAHrC,CAGqC,CAAC;aACxD,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,CAAC,EAAL,CAAK,EAAE,EAAE,CAAC,GAAG,mDAIhC,CAAC;AACH,CAAC;AAED,eACC,KAAY,EACZ,OAAgB;IAChB,IAAM,IAAI,GAAG,6PAaU,OAAO,CAAC,OAAO,6BACnB,OAAO,CAAC,KAAK,+BACX,OAAO,CAAC,OAAO,kCACZ,OAAO,CAAC,UAAU,o5CAoDxC,gBAAgB,CAAC;QACjB,KAAK,CAAC,MAAM,CAAC,GAAG;QAChB,KAAK,CAAC,MAAM,CAAC,MAAM;QACnB,KAAK,CAAC,MAAM,CAAC,EAAE;QACf,KAAK,CAAC,MAAM,CAAC,WAAW;QACxB,KAAK,CAAC,MAAM,CAAC,QAAQ;KAAC,CAAC,uBACZ,KAAK,CAAC,MAAM,CAAC,GAAG,2BACb,KAAK,CAAC,MAAM,CAAC,MAAM,uBACvB,KAAK,CAAC,MAAM,CAAC,EAAE,iCACL,KAAK,CAAC,MAAM,CAAC,WAAW,gCAC3B,KAAK,CAAC,MAAM,CAAC,QAAQ,mxBAuBrC,gBAAgB,CAAC;QAClB,KAAK,CAAC,GAAG,CAAC,UAAU;QACpB,KAAK,CAAC,GAAG,CAAC,OAAO;QACjB,KAAK,CAAC,GAAG,CAAC,UAAU;QACpB,KAAK,CAAC,GAAG,CAAC,KAAK;KAAC,CAAC,+BACC,KAAK,CAAC,GAAG,CAAC,UAAU,+BACvB,KAAK,CAAC,GAAG,CAAC,OAAO,kCACd,KAAK,CAAC,GAAG,CAAC,UAAU,2BACzB,KAAK,CAAC,GAAG,CAAC,KAAK,0qEAmFhB,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,CAAC,wEAIvC,GAAG,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAE/B,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAElB,MAAM,CAAC,IAAI,CAAC;AACb,CAAC;AA5MD,sBA4MC;;;;;;;;;;ACnWD,wCAAgD;AAChD,qCAAwC;AAQxC,IAAI,EAAE,GAAG,CAAC,CAAC;AAEX,eAAsB,MAGrB;IACA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;QACpB,EAAE,EAAE,EAAE,EAAE;QACR,KAAK,EAAE,cAAM,EAAE;QACf,QAAQ,EAAE,mBAAQ,CAAC,EAAE,CAAC;KACtB,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;AAClB,CAAC;AATD,sBASC;;;;;;;;;;ACpBD,qCAAgC;AAQhC,wBACC,EAAyB,EACzB,KAAY,EACZ,OAAgB,EAChB,SAOC;IAED,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,mBAAmB,CAAC,CAAC;QACzC,MAAM,0BAA0B,CAAC;IAElC,IAAM,QAAQ,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,WAAC;QAC5B,IAAM,OAAO,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;QACnC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QACvC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,kBAAkB,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC;QACnE,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,kBAAkB,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC;QACnE,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,CAAC,IAAI,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QACpG,MAAM,CAAC,OAAO,CAAC;IAChB,CAAC,CAAC,CAAC;IAEH,IAAM,WAAW,GAAG,EAAE,CAAC,iBAAiB,EAAE,CAAC;IAE3C,IAAM,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC;IACzD,EAAE,CAAC,YAAY,CAAC,YAAY,EAAE,6PAS3B,CAAC,CAAC;IACL,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;IAE/B,IAAM,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;IACvD,EAAE,CAAC,YAAY,CAAC,YAAY,EAAE,0JAO3B,CAAC,CAAC;IACL,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;IAE/B,IAAM,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC;IACzD,EAAE,CAAC,YAAY,CAAC,YAAY,EAAE,aAAK,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;IACrD,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;IAC/B,EAAE,CAAC,CAAC,EAAE,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QACrC,MAAM,EAAE,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;IAEzC,IAAM,OAAO,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;IACnC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IACvC,EAAE,CAAC,YAAY,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IACvC,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IAExB,IAAM,aAAa,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC;IACzC,EAAE,CAAC,YAAY,CAAC,aAAa,EAAE,YAAY,CAAC,CAAC;IAC7C,EAAE,CAAC,YAAY,CAAC,aAAa,EAAE,YAAY,CAAC,CAAC;IAC7C,EAAE,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;IAE9B,IAAM,QAAQ,GAAG,KAAK,CACrB,CAAC,CAAC,EAAE,CAAC,CAAC,EACN,CAAC,CAAC,EAAE,CAAC,EACL,CAAC,EAAE,CAAC,EACJ,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACR,IAAM,OAAO,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAExC,IAAM,YAAY,GAAG,EAAE,CAAC,YAAY,EAAE,CAAC;IACvC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,YAAY,CAAC,CAAC;IAC7C,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC;IAE3E,IAAM,WAAW,GAAG,EAAE,CAAC,YAAY,EAAE,CAAC;IACtC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,WAAW,CAAC,CAAC;IACpD,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,WAAW,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC;IAEjF,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IAEvB,IAAM,UAAU,GAAG,EAAE,CAAC,kBAAkB,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IAChE,EAAE,CAAC,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;IAExD,IAAM,QAAQ,GAAG,EAAE,CAAC,iBAAiB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;IAC3D,EAAE,CAAC,uBAAuB,CAAC,QAAQ,CAAC,CAAC;IACrC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAE3D,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;IAEjD,IAAI,GAAG,GAAG,KAAK,CAAC;IAEhB,MAAM,CAAC;QACN,MAAM,EAAE;YACP,IAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YACnC,IAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YAEpC,IAAM,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC;gBAChC,IAAI,EAAE,CAAC;gBACP,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;aACrB,EAAE,SAAS,IAAI,EAAE,CAAC,CAAC;YAEpB,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YACvB,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;YACpC,EAAE,CAAC,eAAe,CAAC,EAAE,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;YAChD,EAAE,CAAC,oBAAoB,CAAC,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,iBAAiB,EAAE,EAAE,CAAC,UAAU,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;YACvF,EAAE,CAAC,SAAS,CAAC,EAAE,CAAC,kBAAkB,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;YACtE,EAAE,CAAC,SAAS,CAAC,EAAE,CAAC,kBAAkB,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC9F,EAAE,CAAC,SAAS,CAAC,EAAE,CAAC,kBAAkB,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,UAAU,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YACpF,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;YAEpE,EAAE,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;YAC7B,EAAE,CAAC,eAAe,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;YACzC,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;YACrC,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;YAEpE,GAAG,GAAG,CAAC,GAAG,CAAC;QACZ,CAAC;KACD,CAAC;AACH,CAAC;AA3HD,wCA2HC;;;;;;;;;;ACnID,sCAAyC;AACzC,0CAAqC;AACrC,wCAAgD;AAShD,eAAsB,MAIrB;IACA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;QACpB,MAAM,EAAE,EAAE;QACV,MAAM,EAAE,cAAK,EAAE;QACf,GAAG,EAAE,mBAAQ,CAAC;YACb,UAAU,EAAE,kBAAK,CAAC,CAAC,CAAC;SACpB,CAAC;KACF,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;AAClB,CAAC;AAZD,sBAYC;;;;;;;;;;ACvBD,uCAAyD;AACzD,wCAA4C;AAG5C,sBACC,OAAoB,EACpB,KAAY,EACZ,OAAiB;IAEjB,OAAO,GAAG,OAAO,IAAI,iBAAQ,EAAE,CAAC;IAEhC,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IAChD,MAAM,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC7B,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;IAC/B,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;IAE5B,IAAM,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE;QACrC,qBAAqB,EAAE,KAAK;KAC5B,CAAC,CAAC;IACH,EAAE,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC;QACf,MAAM,CAAC,IAAI,CAAC;IAEb,IAAM,SAAS,GAAG;QACjB,IAAI,EAAE,CAAC;QACP,OAAO,EAAE,KAAK;QACd,KAAK,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;KACzB,CAAC;IAEF,IAAM,QAAQ,GAAG,yBAAc,CAAC,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;IAE/D,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,cAAM,gBAAS,CAAC,OAAO,GAAG,IAAI,EAAxB,CAAwB,CAAC,CAAC;IACrE,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,cAAM,gBAAS,CAAC,OAAO,GAAG,KAAK,EAAzB,CAAyB,CAAC,CAAC;IAEtE,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,eAAK;QACzC,EAAE,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;YACvB,SAAS,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC,WAAW,CAAC;YAC1D,SAAS,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC,YAAY,CAAC;QAC7D,CAAC;IACF,CAAC,CAAC,CAAC;IAEH,IAAI,KAAK,GAAG,CAAC,CAAC;IAEd,cAAc,IAAY;QACzB,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;YAAC,KAAK,GAAG,IAAI,CAAC;QACzB,SAAS,CAAC,IAAI,GAAG,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC;QAEzC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAElB,qBAAqB,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,qBAAqB,CAAC,IAAI,CAAC,CAAC;AAC7B,CAAC;AAhDD,oCAgDC;;;;;;;;;;ACpDD,sCAcgB;AAGhB,qBAAY,CACX,QAAQ,CAAC,IAAI,EACb,cAAK,CAAC;IACL,GAAG,EAAE,iBAAQ,CAAC;QACb,OAAO,EAAE,cAAK,CAAC,IAAI,CAAC;KACpB,CAAC;IACF,MAAM,EAAE,cAAK,CAAC;QACb,WAAW,EAAE,cAAK,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;QACtC,QAAQ,EAAE,cAAK,CAAC,CAAC,CAAC;QAClB,QAAQ,EAAE,cAAK,CAAC,GAAG,CAAC;QACpB,MAAM,EAAE,cAAK,CAAC,CAAC,CAAC;QAChB,MAAM,EAAE,cAAK,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC;KACzB,CAAC;IACF,MAAM,EAAE;QACP,cAAK,CAAC;YACL,KAAK,EAAE,cAAK,CAAC,cAAK,CAAC,IAAI,CAAC,EACvB,eAAM,EAAE,CAAC;YACV,QAAQ,EAAE,kBAAS,CAAC;gBACnB,KAAK,EAAE,cAAK,CAAC,CAAC,CAAC;gBACf,SAAS,EAAE,cAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBACzB,MAAM,EAAE,cAAK,CAAC,IAAI,CAAC;gBACnB,OAAO,EAAE,cAAK,CAAC,CAAC,CAAC;aACjB,CAAC;SACF,CAAC;QACF,cAAK,CAAC;YACL,KAAK,EAAE,cAAK,CAAC,cAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,cAAK,CAAC,GAAG,CAAC,CAAC;YACxC,QAAQ,EAAE,iBAAQ,CAAC;gBAClB,KAAK,EAAE,cAAK,CAAC,GAAG,CAAC;aACjB,CAAC;SACF,CAAC;QACF,cAAK,CAAC;YACL,KAAK,EAAE,qBAAY,EAAE;YACrB,QAAQ,EAAE,iBAAQ,CAAC;gBAClB,KAAK,EAAE,cAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;aAC3B,CAAC;SACF,CAAC;KACF;CACD,CAAC,EAAE,gBAAO,CAAC;IACX,KAAK,EAAE,GAAG;IACV,MAAM,EAAE,GAAG;IACX,OAAO,EAAE,IAAI;IACb,KAAK,EAAE,GAAG;IACV,OAAO,EAAE,CAAC;IACV,UAAU,EAAE,CAAC;IACb,YAAY,EAAE,IAAI;IAClB,MAAM,EAAE,CAAC;CACT,CAAC,CAAC,CAAC","file":"docs/index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e83120b03b2a3b42fc5a","/**\n * GLSL Code\n */\nexport type Code = string;\nexport interface Expression {\n\treadonly id: string,\n\treadonly body: Code,\n\treadonly dependencies: Expression[],\n\treadonly toString: () => string;\n}\n\nlet context: Expression[] = [];\n\nexport function expression(body: Code): Expression {\n\tlet id = generateId(body);\n\tlet self = {\n\t\tid: id,\n\t\tbody: body,\n\t\tdependencies: context,\n\t\ttoString: () => {\n\t\t\tif (context.indexOf(self) === -1)\n\t\t\t\tcontext.push(self);\n\t\t\treturn id;\n\t\t}\n\t};\n\tcontext = [];\n\treturn self;\n}\n\nfunction generateId(body: Code): string {\n\treturn \"a\" + hash(body).toString(16);\n}\n\nfunction hash(x: string): number {\n\tlet hash = 5381;\n\n\tfor (let i = 0; i < x.length; i++)\n\t\thash = (hash * 33) ^ x.charCodeAt(i);\n\n\treturn hash >>> 0;\n}\n\nexport function value(\n\tx: number = 0,\n\ty: number = x,\n\tz: number = y): Expression {\n\treturn expression(`vec3(${x.toPrecision(10)}, ${y.toPrecision(10)}, ${z.toPrecision(10)})`);\n}\n\nexport function variable(name: string): Expression {\n\treturn expression(name);\n}\n\nexport function random(x: Expression): Expression {\n\treturn expression(`fract(sin(dot(${x} + 1000.0, vec3(12.9898, 78.233, 26.724))) * 43758.5453)`);\n}\n\nexport function minNorm(x: Expression): Expression {\n\treturn expression(`min(min(${x}.x, ${x}.y), ${x}.z)`);\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/expression.ts","import { Expression, expression, value } from './expression';\n\nexport interface Material {\n\treadonly transmittance: Expression,\n\treadonly smoothness: Expression,\n\treadonly refraction: Expression,\n\treadonly scatter: Expression,\n\treadonly color: Expression,\n\treadonly emissivity: Expression\n}\n\nexport function material(values?: {\n\ttransmittance?: Expression,\n\tsmoothness?: Expression,\n\trefraction?: Expression,\n\tscatter?: Expression,\n\tcolor?: Expression,\n\temissivity?: Expression\n}): Material {\n\treturn Object.assign({\n\t\ttransmittance: value(0),\n\t\tsmoothness: value(0),\n\t\trefraction: value(1),\n\t\tscatter: value(1e20),\n\t\tcolor: value(1, 1, 1),\n\t\temissivity: value(0, 0, 0)\n\t}, values || {});\n}\n\nexport function spotlight(options: {\n\tdirection?: Expression,\n\tcolor?: Expression,\n\tspread?: Expression,\n\tambient?: Expression,\n}): Material {\n\toptions = options || {};\n\tlet direction = options.direction || value(0, 1, 0);\n\tlet color = options.color || value(1, 1, 1);\n\tlet spread = options.spread || value(1);\n\tlet ambient = options.ambient || value(0);\n\treturn material({\n\t\tcolor: value(0),\n\t\temissivity: expression(\n\t\t\t`${color} / ${spread}.x * pow(dot(normalize(p), normalize(${direction})) * 0.5 + 0.5, 1.0 / ${spread}.x - 1.0) + ${ambient}`)\n\t});\n}\n\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/material.ts","import { Expression, expression, value } from './expression';\n\nexport interface Camera {\n\treadonly eye: Expression,\n\treadonly target: Expression,\n\treadonly up: Expression,\n\treadonly fieldOfView: Expression,\n\treadonly aperture: Expression\n}\n\nexport interface CameraOptions {\n\teye?: Expression,\n\ttarget?: Expression,\n\tup?: Expression,\n\tfieldOfView?: Expression,\n\taperture?: Expression\n}\n\nexport function camera(values?: CameraOptions): Camera {\n\tvalues = values || {};\n\treturn {\n\t\teye: values.eye || value(0, 0, -1),\n\t\ttarget: values.target || value(0, 0, 0),\n\t\tup: values.up || value(0, 1, 0),\n\t\tfieldOfView: values.fieldOfView || value(90 / 180.0 * Math.PI),\n\t\taperture: values.aperture || value(0.0)\n\t};\n}\n\nexport function orbit(values?: {\n\ttarget?: Expression,\n\tdistance?: Expression,\n\tup?: Expression,\n\tfieldOfView?: Expression,\n\taperture?: Expression\n\toffset?: Expression\n}): Camera {\n\tvalues = values || {};\n\tvalues.target = values.target || value(0, 0, 0);\n\tvalues.offset = values.offset || value(0, 0);\n\tvalues.distance = values.distance || value(1);\n\treturn camera({\n\t\ttarget: values.target,\n\t\teye: expression(\n\t\t\t`${values.target} + ${values.distance}.x * spherical((mouse + ${values.offset}.xy) * vec2(PI, 0.5 * PI) + vec2(0.5 * PI))`),\n\t\tup: values.up,\n\t\tfieldOfView: values.fieldOfView,\n\t\taperture: values.aperture\n\t});\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/camera.ts","export interface Options {\n    readonly width: number,\n    readonly height: number,\n    readonly epsilon: number,\n    readonly steps: number,\n    readonly bounces: number,\n    readonly iterations: number,\n    readonly memory: number,\n    readonly cheapNormals: boolean\n}\n\nexport function options(values?: {\n    width?: number,\n    height?: number,\n    epsilon?: number,\n    steps?: number,\n    bounces?: number,\n    iterations?: number,\n    memory?: number,\n    cheapNormals?: boolean\n}): Options {\n    values = values || {};\n    return Object.assign({\n        width: 256,\n        height: 256,\n        epsilon: 1e-5,\n        steps: 100,\n        bounces: 8,\n        iterations: 1,\n        memory: 1.0,\n        cheapNormals: false\n    }, values || {});\n}\n\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/options.ts","import { Expression, expression, value, random, minNorm } from './expression';\n\nexport interface Shape {\n\treadonly call: (position: Expression) => Expression,\n}\n\nfunction shape(call: (position: Expression) => Expression): Shape {\n\treturn {\n\t\tcall: call\n\t};\n}\n\nexport function zero(): Shape {\n\treturn shape(p =>\n\t\texpression(`MAX_VALUE`));\n}\n\nexport function unit(): Shape {\n\treturn shape(p =>\n\t\texpression(`-MAX_VALUE`));\n}\n\nexport function sphere(): Shape {\n\treturn shape(p =>\n\t\texpression(`length(${p}) - 0.5`));\n}\n\nexport function plane(normal: Expression, offset: Expression): Shape {\n\treturn shape(p =>\n\t\texpression(`dot(${p}, ${normal}) + ${offset}.x`));\n}\n\nfunction unitShape(normals: Expression[]): Shape {\n\treturn normals.reduce((s, n) =>\n\t\tintersection(s,\n\t\t\tplane(n, value(-0.5))),\n\t\tunit());\n}\n\nexport function tetrahedron(): Shape {\n\tlet l = Math.sqrt(3);\n\treturn unitShape([\n\t\tvalue(-1 / l, -1 / l, -1 / l),\n\t\tvalue(-1 / l, 1 / l, 1 / l),\n\t\tvalue(1 / l, -1 / l, 1 / l),\n\t\tvalue(1 / l, 1 / l, -1 / l),\n\t]);\n}\n\nexport function cube(): Shape {\n\treturn unitShape([\n\t\tvalue(1, 0, 0),\n\t\tvalue(-1, 0, 0),\n\t\tvalue(0, 1, 0),\n\t\tvalue(0, -1, 0),\n\t\tvalue(0, 0, 1),\n\t\tvalue(0, 0, -1)\n\t]);\n}\n\nexport function Octohedron(): Shape {\n\tlet l = Math.sqrt(3);\n\treturn unitShape([\n\t\tvalue(1 / l, 1 / l, 1 / l),\n\t\tvalue(1 / l, 1 / l, -1 / l),\n\t\tvalue(1 / l, -1 / l, 1 / l),\n\t\tvalue(1 / l, -1 / l, -1 / l),\n\t\tvalue(-1 / l, 1 / l, 1 / l),\n\t\tvalue(-1 / l, 1 / l, -1 / l),\n\t\tvalue(-1 / l, -1 / l, 1 / l),\n\t\tvalue(-1 / l, -1 / l, -1 / l),\n\t]);\n}\n\nexport function dodecahedron(): Shape {\n\tlet phi = 0.5 * (1 + Math.sqrt(5));\n\tlet l = Math.sqrt(phi * phi + 1);\n\treturn unitShape([\n\t\tvalue(phi / l, 1 / l, 0),\n\t\tvalue(phi / l, -1 / l, 0),\n\t\tvalue(0, phi / l, 1 / l),\n\t\tvalue(0, phi / l, -1 / l),\n\t\tvalue(1 / l, 0, phi / l),\n\t\tvalue(-1 / l, 0, phi / l),\n\t\tvalue(-phi / l, 1 / l, 0),\n\t\tvalue(-phi / l, -1 / l, 0),\n\t\tvalue(0, -phi / l, 1 / l),\n\t\tvalue(0, -phi / l, -1 / l),\n\t\tvalue(1 / l, 0, -phi / l),\n\t\tvalue(-1 / l, 0, -phi / l)\n\t]);\n}\n\n\n\nexport function cylinder(): Shape {\n\treturn shape(p =>\n\t\texpression(`length(${p}.xz) - 0.5`));\n}\n\nexport function torus(): Shape {\n\treturn shape(p =>\n\t\texpression(`length(vec2(length(${p}.xz) - 0.5, ${p}.y)) - 0.1`));\n}\n\nexport function translate(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\ta.call(expression(`${p} - ${x}`)));\n}\n\nexport function scale(x: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet q = a.call(expression(`${p} / ${x}.x`));\n\t\treturn expression(`${q} * ${x}.x`);\n\t});\n}\n\nexport function max(a: Shape): Shape {\n\treturn shape(p =>\n\t\ta.call(expression(`max(${p}, 0.0)`)));\n}\n\nexport function stretch(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\texpression(`${a.call(expression(`${p} / ${x}`))} * ${minNorm(x)}`));\n}\n\nexport function repeat(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\ta.call(expression(`mod(${p} - ${x} * 0.5, ${x}) - ${x} * 0.5`)));\n}\n\nexport function union(a: Shape, b: Shape): Shape {\n\treturn shape(p => {\n\t\tlet da = a.call(p);\n\t\tlet db = b.call(p);\n\t\treturn expression(`min(${da}, ${db})`)\n\t});\n}\n\nexport function intersection(a: Shape, b: Shape): Shape {\n\treturn shape(p => {\n\t\tlet da = a.call(p);\n\t\tlet db = b.call(p);\n\t\treturn expression(`max(${da}, ${db})`)\n\t});\n}\n\nexport function difference(a: Shape, b: Shape): Shape {\n\treturn shape(p => {\n\t\tlet da = a.call(p);\n\t\tlet db = b.call(p);\n\t\treturn expression(`max(${da}, -${db})`)\n\t});\n}\n\nexport function blend(k: Expression, a: Shape, b: Shape): Shape {\n\treturn shape(p => {\n\t\tlet da = a.call(p);\n\t\tlet db = b.call(p);\n\t\tlet h = expression(`clamp(0.5 + 0.5 * (${db} - ${da}) / ${k}, 0.0, 1.0)`);\n\t\treturn expression(`mix(${db}, ${da}, ${h}) - ${k} * ${h} * (1.0 - ${h})`);\n\t});\n}\n\nexport function expand(k: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet da = a.call(p);\n\t\treturn expression(`${da} - ${k}.x`)\n\t});\n}\n\nexport function twistX(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\trotateX(expression(`vec3(${p}.x * ${x}.x)`), a).call(p));\n}\n\nexport function twistY(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\trotateY(expression(`vec3(${p}.y * ${x}.x)`), a).call(p));\n}\n\nexport function twistZ(x: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\trotateZ(expression(`vec3(${p}.z * ${x}.x)`), a).call(p));\n}\n\nexport function rotateX(x: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet c = expression(`cos(${x}.x), sin(${x}.x), 0`);\n\t\treturn a.call(expression(`mat3(1, 0, 0, 0, ${c}.x, ${c}.y, 0, -${c}.y, ${c}.x) * ${p}`))\n\t});\n}\n\nexport function rotateY(x: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet c = expression(`cos(${x}.x), sin(${x}.x), 0`);\n\t\treturn a.call(expression(`mat3(${c}.x, 0, -${c}.y, 0, 1, 0, ${c}.y, 0, ${c}.x) * ${p}`))\n\t});\n}\n\nexport function rotateZ(x: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet c = expression(`cos(${x}.x), sin(${x}.x), 0`);\n\t\treturn a.call(expression(`mat3(${c}.x, ${c}.y, 0, -${c}.y, ${c}.x, 0, 0, 0, 1) * ${p}`))\n\t});\n}\n\nexport function rotate(axis: Expression, x: Expression, a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet u = expression(`normalize(${axis})`);\n\t\tlet c = expression(`cos(${x}.x), sin(${x}.x), 0`);\n\t\treturn a.call(expression(`mat3(\n\t\t\t${c}.x + ${u}.x * ${u}.x * (1.0 - ${c}.x), \n\t\t\t${u}.x * ${u}.y * (1.0 - ${c}.x) - ${u}.z * ${c}.y,\n\t\t\t${u}.x * ${u}.z * (1.0 - ${c}.x) + ${u}.y * ${c}.y,\n\t\t\t${u}.y * ${u}.x * (1.0 - ${c}.x) + ${u}.z * ${c}.y,\n\t\t\t${c}.x + ${u}.y * ${u}.y * (1.0 - ${c}.x),\n\t\t\t${u}.x * ${u}.y * (1.0 - ${c}.x) - ${u}.x * ${c}.y,\n\t\t\t${u}.z * ${u}.x * (1.0 - ${c}.x) - ${u}.y * ${c}.y,\n\t\t\t${u}.z * ${u}.y * (1.0 - ${c}.x) + ${u}.x * ${c}.y,\n\t\t\t${c}.x +  ${u}.z * ${u}.z * (1.0 - ${c}.x)) * ${p}`));\n\t});\n}\n\nexport function wrapX(a: Shape): Shape {\n\treturn shape(p => {\n\t\tlet c = expression(`length(p.yz)`);\n\t\treturn a.call(expression(`${p}.x, ${c}.x, asin(${p}.z / ${c}.x)`));\n\t});\n}\n\nexport function mirror(n: Expression, a: Shape): Shape {\n\treturn shape(p =>\n\t\ta.call(expression(`${p} - 2.0 * min(0.0, dot(${p}, ${n})) * ${n}`)));\n}\n\nexport function smoothBox(dimensions: Expression, radius: Expression): Shape {\n\treturn mirror(value(1, 0, 0),\n\t\tmirror(value(0, 1, 0),\n\t\t\tmirror(value(0, 0, 1),\n\t\t\t\ttranslate(expression(`0.5 * (${dimensions} - ${radius})`),\n\t\t\t\t\tmax(\n\t\t\t\t\t\tscale(radius,\n\t\t\t\t\t\t\tsphere()))))));\n}\n\nexport function sierpinski(iterations: number = 5, a: Shape = tetrahedron()): Shape {\n\tlet l = Math.sqrt(2);\n\treturn Array(iterations)\n\t\t.fill(0)\n\t\t.reduce((shape, i) =>\n\t\t\tmirror(value(1 / l, 1 / l, 0),\n\t\t\t\tmirror(value(0, 1 / l, 1 / l),\n\t\t\t\t\tmirror(value(1 / l, 0, 1 / l),\n\t\t\t\t\t\tscale(value(0.5),\n\t\t\t\t\t\t\ttranslate(value(0.5 * Math.sqrt(3)),\n\t\t\t\t\t\t\t\tshape))))), a);\n}\n\nexport function tree(iterations: number = 8): Shape {\n\tlet factor = 0.58;\n\tlet length = 1.2;\n\tlet width = 0.1;\n\tlet angle = 50;\n\n\treturn Array(iterations)\n\t\t.fill(0)\n\t\t.reduce((shape, _, i) =>\n\t\t\tblend(\n\t\t\t\tvalue(0.15 * Math.pow(factor, i)),\n\t\t\t\tshape,\n\t\t\t\tmirror(value(1 / Math.sqrt(2), 0, 1 / Math.sqrt(2)),\n\t\t\t\t\tmirror(value(1 / Math.sqrt(2), 0, -1 / Math.sqrt(2)),\n\t\t\t\t\t\ttranslate(\n\t\t\t\t\t\t\tvalue(\n\t\t\t\t\t\t\t\tlength * factor / 2 * Math.sin(angle / 180 * Math.PI),\n\t\t\t\t\t\t\t\tlength / 2 * (1 + factor / 2 * Math.cos(angle / 180 * Math.PI)),\n\t\t\t\t\t\t\t\t0),\n\t\t\t\t\t\t\tscale(value(factor),\n\t\t\t\t\t\t\t\trotateY(value(0.1),\n\t\t\t\t\t\t\t\t\trotateZ(value(angle / 180 * Math.PI),\n\t\t\t\t\t\t\t\t\t\tshape))))))),\n\t\tsmoothBox(value(width, length, width), value(width / 2)));\n}\n\nexport function modulate(\n\tx: Expression,\n\ta: (index: Expression) => Shape,\n\tbuffer: Expression = value(0.01)): Shape {\n\treturn shape(p => {\n\t\tlet offset = expression(`${p} + ${x} * 0.5`);\n\t\tlet index = expression(`floor(${offset} / ${x})`);\n\t\tlet center = expression(`${index} * ${x}`);\n\t\tlet local = expression(`${p} - ${center}`);\n\t\tlet mask = shape(p => {\n\t\t\tlet a = expression(`${buffer} + ${x} * 0.5 - abs(${p})`);\n\t\t\treturn expression(`min(min(${a}.x, ${a}.y), ${a}.z)`);\n\t\t});\n\t\treturn union(mask, a(index))\n\t\t\t.call(local);\n\t});\n}\n\nexport function choose(x: Expression, shapes: Shape[]): Shape {\n\treturn shape(p => {\n\t\treturn expression(shapes\n\t\t\t.map(_ => _.call(p))\n\t\t\t.reduce((code, d, i) =>\n\t\t\t\tcode + `${x}.x < ${((i + 1) / shapes.length).toPrecision(6)} ? ${d} : `, \"\") + \"vec3(0)\");\n\t});\n}\n\nexport function truchet(): Shape {\n\tlet base = intersection(cube(), union(union(\n\t\ttranslate(value(0.5, 0, 0.5), torus()),\n\t\ttranslate(value(-0.5, 0.5, 0),\n\t\t\trotateX(value(Math.PI / 2),\n\t\t\t\ttorus()))),\n\t\ttranslate(value(0, -0.5, -0.5),\n\t\t\trotateZ(value(Math.PI / 2),\n\t\t\t\ttorus()))));\n\treturn modulate(value(1, 1, 1), index =>\n\t\tchoose(random(index), [\n\t\t\tbase,\n\t\t\trotateX(value(Math.PI / 2), base),\n\t\t\trotateX(value(Math.PI), base),\n\t\t\trotateX(value(3 * Math.PI / 2), base)\n\t\t]));\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/shape.ts","export * from \"./expression\";\nexport * from \"./model\";\nexport * from \"./material\";\nexport * from \"./scene\";\nexport * from \"./shape\";\nexport * from \"./viewer\";\nexport * from \"./camera\";\nexport * from \"./options\";\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/index.ts","import { Code, Expression, expression, variable } from './expression';\nimport { Model } from './model';\nimport { Options } from './options';\nimport { Scene } from './scene';\n\nfunction buildExpression(expression: Expression) {\n\treturn buildExpressions([expression]);\n}\n\nfunction buildExpressions(expressions: Expression[]) {\n\treturn dependencieses(expressions)\n\t\t.map(expression => `\tvec3 ${expression} = vec3(${expression.body});`)\n\t\t.reduce((a, b) => a + \"\\n\" + b, \"\");\n}\n\nfunction dependencies(expression: Expression): Expression[] {\n\treturn uniqueExpressions(\n\t\tdependencieses(expression.dependencies)\n\t\t\t.concat(expression));\n}\n\nfunction dependencieses(expressions: Expression[]): Expression[] {\n\treturn uniqueExpressions(\n\t\texpressions\n\t\t\t.map(_ => dependencies(_))\n\t\t\t.reduce((a, b) => a.concat(b), []));\n}\n\nfunction uniqueExpressions(expressions: Expression[]): Expression[] {\n\treturn expressions.filter((x, i) =>\n\t\texpressions.findIndex(_ => _.id === x.id) === i);\n}\n\nfunction buildModel(\n\tmodel: Model,\n\toptions: {\n\t\tcheapNormals: boolean\n\t}): Code {\n\tlet distance = model.shape.call(variable(\"p\"));\n\tlet code = `\n\t\nfloat distance${model.id}(vec3 p) {\n\t${buildExpression(distance)}\n\treturn ${distance}.x;\n}\n\nMaterial material${model.id}(vec3 p, vec3 n, vec3 d) {\n\tMaterial m;\n\t${buildExpressions([\n\t\t\tmodel.material.transmittance,\n\t\t\tmodel.material.smoothness,\n\t\t\tmodel.material.refraction,\n\t\t\tmodel.material.scatter,\n\t\t\tmodel.material.color,\n\t\t\tmodel.material.emissivity])}\n\tm.transmittance = ${model.material.transmittance}.x;\n\tm.smoothness = ${model.material.smoothness}.x;\n\tm.refraction = ${model.material.refraction}.x;\n\tm.scatter = ${model.material.scatter}.x;\n\tm.color = ${model.material.color};\n\tm.emissivity = ${model.material.emissivity};\n\treturn m;\n}`;\n\n\tif (options.cheapNormals)\n\t\tcode += `\n\nvec3 normal${model.id}(vec3 p) {\n\tconst vec3 a = vec3( 1, 1, 1) / sqrt(3.0);\n\tconst vec3 b = vec3( 1,-1,-1) / sqrt(3.0);\n\tconst vec3 c = vec3(-1, 1,-1) / sqrt(3.0);\n\tconst vec3 d = vec3(-1,-1, 1) / sqrt(3.0);\n\tfloat z = distance${model.id}(p);\n\treturn normalize(\n\t\ta * (distance${model.id}(p + a * epsilon) - z) + \n\t\tb * (distance${model.id}(p + b * epsilon) - z) +\n\t\tc * (distance${model.id}(p + c * epsilon) - z) +\n\t\td * (distance${model.id}(p + d * epsilon) - z));\n}`;\n\n\telse\n\t\tcode += `\n\nvec3 normal${model.id}(vec3 p) {\n\treturn normalize(vec3(\n\t\tdistance${model.id}(p + vec3(epsilon, 0, 0)) -\n\t\tdistance${model.id}(p - vec3(epsilon, 0, 0)),\n\t\tdistance${model.id}(p + vec3(0, epsilon, 0)) -\n\t\tdistance${model.id}(p - vec3(0, epsilon, 0)),\n\t\tdistance${model.id}(p + vec3(0, 0, epsilon)) -\n\t\tdistance${model.id}(p - vec3(0, 0, epsilon))));\n}`;\n\n\treturn code;\n}\n\nfunction buildScene(\n\tscene: Scene,\n\toptions: {\n\t\tcheapNormals: boolean\n\t}): Code {\n\treturn scene.models\n\t\t.map(_ => buildModel(_, options))\n\t\t.reduce((a, b) => a + b, \"\") + `\n\t\t\nClosest calculateClosest(vec3 position) {\n\tClosest closest;\n\tfloat distance;\n\n\tclosest.object = 0;\n\tclosest.distance = MAX_VALUE;` +\n\n\t\tscene.models\n\t\t\t.map((model, i) => `\n\t\n\tdistance = abs(distance${model.id}(position));\n\tif (distance < closest.distance) {\n\t\tclosest.distance = distance;\n\t\tclosest.object = ${model.id};\n\t}`)\n\t\t\t.reduce((a, b) => a + b, \"\") + `\n\t\n\treturn closest;\n}\n\nvec3 calculateNormal(int object, vec3 position) {` +\n\n\t\tscene.models\n\t\t\t.map((model, i) => `\n\t\n\tif (object == ${model.id})\n\t\treturn normal${model.id}(position);`)\n\t\t\t.reduce((a, b) => a + b, \"\") + `\n\t\n\treturn vec3(0, 0, 0);\n}\n\nMaterial calculateMaterial(int object, vec3 position, vec3 normal, vec3 direction) {` +\n\n\t\tscene.models\n\t\t\t.map((model, i) => `\n\t\n\tif (object == ${model.id})\n\t\treturn material${model.id}(position, normal, direction);`)\n\t\t\t.reduce((a, b) => a + b, \"\") + `\n\t\n\tMaterial material;\n\treturn material;\n}`;\n}\n\nexport function build(\n\tscene: Scene,\n\toptions: Options): Code {\n\tconst code = `\nprecision highp float;\n\nuniform sampler2D texture;\nuniform vec2 resolution;\nuniform vec2 mouse;\nuniform bool clicked;\nuniform float time;\nvarying vec2 uv;\n\nconst float PI = 3.14159;\nconst float MAX_VALUE = 1e5;\n\nconst float epsilon = ${options.epsilon};\nconst int steps = ${options.steps};\nconst int bounces = ${options.bounces};\nconst int iterations = ${options.iterations};\n\nstruct Closest {\n\tint object;\n\tfloat distance;\n};\n\nstruct Material {\n\tfloat transmittance;\n\tfloat smoothness;\n\tfloat refraction;\n\tfloat scatter;\n\tvec3 color;\n\tvec3 emissivity;\n};\n\nClosest calculateClosest(vec3 position);\nvec3 calculateNormal(int object, vec3 position);\nMaterial calculateMaterial(int object, vec3 position, vec3 normal, vec3 direction);\n\nvec2 random(int seed) {\n\tvec2 s = (uv + vec2(1, 1)) * (1.0 + time + float(seed));\n\treturn vec2(\n\t\tfract(sin(dot(s.xy, vec2(12.9898, 78.233))) * 43758.5453),\n\t\tfract(cos(dot(s.xy, vec2(4.898, 7.23))) * 23421.631));\n}\n\nvec3 ortho(vec3 v) {\n\treturn abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y);\n}\n\nvec3 calculateSample(vec3 normal, float smoothness, vec2 noise) {\n\tvec3 o1 = normalize(ortho(normal));\n\tvec3 o2 = normalize(cross(normal, o1));\n\tnoise.x *= 2.0 * PI;\n\tnoise.y = sqrt(smoothness + (1.0 - smoothness) * noise.y);\n\tfloat q = sqrt(1.0 - noise.y * noise.y);\n\treturn q * (cos(noise.x) * o1  + sin(noise.x) * o2) + noise.y * normal;\n}\n\nvec3 sampleSphere(vec2 noise) {\n\tnoise.x *= 2.0 * PI;\n\tnoise.y = noise.y * 2.0 - 1.0;\n\tfloat q = sqrt(1.0 - noise.y * noise.y);\n\treturn vec3(q * cos(noise.x), q * sin(noise.x), noise.y);\n}\n\nvec3 spherical(vec2 angle) {\n\treturn vec3(sin(angle.y) * cos(angle.x), cos(angle.y), sin(angle.y) * sin(angle.x));\n}\n\nvoid main() {\n\t${buildExpressions([\n\t\t\tscene.camera.eye,\n\t\t\tscene.camera.target,\n\t\t\tscene.camera.up,\n\t\t\tscene.camera.fieldOfView,\n\t\t\tscene.camera.aperture])}\n\tvec3 eye = ${scene.camera.eye};\n\tvec3 target = ${scene.camera.target};\n\tvec3 up = ${scene.camera.up};\n\tfloat fieldOfView = ${scene.camera.fieldOfView}.x;\n\tfloat aperture = ${scene.camera.aperture}.x;\n\n\tvec3 look = normalize(target - eye);\n\tup = normalize(up - dot(look, up) * look);\n\tvec3 right = cross(look, up);\n\t\n\tvec3 total;\n\n\tfor(int iteration = 1; iteration <= iterations; iteration++) {\n\t\tvec2 noise = random(iteration);\n\n\t\tvec2 offset = noise.x * aperture * vec2(cos(noise.y * 2.0 * PI), sin(noise.y * 2.0 * PI));\n\t\tvec3 from = eye + offset.x * right + offset.y * up;\n\n\t\tvec2 angle = (uv * 0.5 + (noise - 0.5) / resolution) * fieldOfView;\n\t\tvec3 screen = vec3(cos(angle.y) * sin(angle.x), sin(angle.y), cos(angle.y) * cos(angle.x));\n\t\tvec3 to = eye + length(target - eye) * (right * screen.x + up * screen.y + look * screen.z);\n\n\t\tvec3 direction = normalize(to - from);\n\n\t\tvec3 luminance = vec3(1);\n\n\t\tMaterial air;\n\t\t${buildExpressions([\n\t\t\tscene.air.refraction,\n\t\t\tscene.air.scatter,\n\t\t\tscene.air.emissivity,\n\t\t\tscene.air.color])}\n\t\tair.refraction = ${scene.air.refraction}.x;\n\t\tair.scatter = ${scene.air.scatter}.x;\n\t\tair.emissivity = ${scene.air.emissivity};\n\t\tair.color = ${scene.air.color};\n\n\t\tMaterial current = air;\n\n\t\tfor (int bounce = 1; bounce <= bounces; bounce++) {\n\t\t\tClosest closest;\n\t\t\tvec3 position = from;\n\t\t\tfloat distance = 0.0;\n\n\t\t\tvec2 noise = random(iteration * bounces + bounce);\n\n\t\t\tfloat scatter = -log(noise.y) * current.scatter;\n\n\t\t\tfor (int step = 1; step <= steps; step++) {\n\t\t\t\tclosest = calculateClosest(position);\n\n\t\t\t\tif (closest.distance < epsilon)\n\t\t\t\t\tbreak;\n\n\t\t\t\tdistance = distance + closest.distance * 0.9;\n\t\t\t\tdistance = min(distance, scatter);\n\t\t\t\tposition = from + direction * distance;\n\n\t\t\t\tif (distance == scatter)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (closest.object == 0)\n\t\t\t\tbreak;\n\n\t\t\tif (distance == scatter) {\n\t\t\t\tfrom = position;\n\t\t\t\tdirection = sampleSphere(noise);\n\t\t\t\ttotal += luminance * current.emissivity;\n\t\t\t\tluminance *= current.color;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvec3 normal = calculateNormal(closest.object, position);\n\n\t\t\tMaterial material = calculateMaterial(closest.object, position, normal, direction);\n\n\t\t\ttotal += luminance * material.emissivity;\n\n\t\t\tif (material.color == vec3(0))\n\t\t\t\tbreak;\n\n\t\t\tbool backface = dot(direction, normal) > 0.0; \n\t\t\tif (backface)\n\t\t\t\tnormal = -normal; \n\n\t\t\tnormal = calculateSample(normal, material.smoothness, noise);\n\t\t\t\n\t\t\tif (noise.y < material.transmittance) {\n\t\t\t\tfloat eta;\n\t\t\t\tif (!backface)\n\t\t\t\t\teta = current.refraction / material.refraction;\n\t\t\t\telse\n\t\t\t\t\teta = material.refraction / air.refraction;\n\t\t\t\n\t\t\t\tvec3 refracted = refract(direction, normal, eta);\n\t\t\t\tif (refracted != vec3(0)) {\n\t\t\t\t\tfrom = position - 5.0 * epsilon * normal;\n\t\t\t\t\tdirection = refracted;\n\t\t\t\t\tif (!backface)\n\t\t\t\t\t\tcurrent = material;\n\t\t\t\t\telse\n\t\t\t\t\t\tcurrent = air;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tluminance *= material.color;\t\t\t\t\n\t\t\tfrom = position + 5.0 * epsilon * normal;\n\t\t\tdirection = reflect(direction, normal);\n\t\t}\n\t}\n\n\tvec4 original = texture2D(texture, uv * 0.5 - 0.5);\n\t\n\tif (clicked) \n\t\toriginal *= 0.5;\n\n\toriginal *= ${options.memory.toFixed(10)}; \n\t\t\n\tgl_FragColor = original + vec4(total, iterations);\n\n}` + buildScene(scene, options);\n\n\tconsole.log(code);\n\n\treturn code;\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/build.ts","import { Material, material } from './material';\nimport { Shape, sphere } from './shape';\n\nexport interface Model {\n\treadonly id: number,\n\treadonly shape: Shape,\n\treadonly material: Material\n}\n\nlet id = 1;\n\nexport function model(values?: {\n\tshape?: Shape,\n\tmaterial?: Material\n}): Model {\n\treturn Object.assign({\n\t\tid: id++,\n\t\tshape: sphere(),\n\t\tmaterial: material({})\n\t}, values || {});\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/model.ts","import { build } from './build';\nimport { Options } from './options';\nimport { Scene } from './scene';\n\nexport interface Renderer {\n\treadonly render: () => void;\n}\n\nexport function createRenderer(\n\tgl: WebGLRenderingContext,\n\tscene: Scene,\n\toptions: Options,\n\tvariables?: {\n\t\ttime: number,\n\t\tclicked: boolean,\n\t\tmouse: {\n\t\t\tx: number,\n\t\t\ty: number\n\t\t}\n\t}) {\n\n\tif (!gl.getExtension(\"OES_texture_float\"))\n\t\tthrow \"No float texture support\";\n\n\tconst textures = [0, 1].map(_ => {\n\t\tconst texture = gl.createTexture();\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, options.width, options.height, 0, gl.RGBA, gl.FLOAT, null);\n\t\treturn texture;\n\t});\n\n\tconst framebuffer = gl.createFramebuffer();\n\n\tconst renderShader = gl.createShader(gl.FRAGMENT_SHADER);\n\tgl.shaderSource(renderShader, `\n\t\tprecision highp float;\n\n\t\tvarying vec2 uv;\n\t\tuniform sampler2D texture;\n\t\t\n\t\tvoid main() {\n\t\t\tvec4 result = texture2D(texture, uv * 0.5 - 0.5);\n\t\t\tgl_FragColor = vec4(pow(result.xyz / result.w, vec3(1.0 / 2.2)), 1.0);\n\t\t}`);\n\tgl.compileShader(renderShader);\n\n\tconst vertexShader = gl.createShader(gl.VERTEX_SHADER);\n\tgl.shaderSource(vertexShader, `\n\t\tattribute vec2 position;\n\t\tvarying vec2 uv;\n\t\t\n\t\tvoid main() {\n\t\t\tgl_Position = vec4(position, 0, 1);\n\t\t\tuv = position.xy;\n\t\t}`);\n\tgl.compileShader(vertexShader);\n\n\tconst screenShader = gl.createShader(gl.FRAGMENT_SHADER);\n\tgl.shaderSource(screenShader, build(scene, options));\n\tgl.compileShader(screenShader);\n\tif (gl.getShaderInfoLog(screenShader))\n\t\tthrow gl.getShaderInfoLog(screenShader);\n\n\tconst program = gl.createProgram();\n\tgl.attachShader(program, vertexShader);\n\tgl.attachShader(program, screenShader);\n\tgl.linkProgram(program);\n\n\tconst renderProgram = gl.createProgram();\n\tgl.attachShader(renderProgram, vertexShader);\n\tgl.attachShader(renderProgram, renderShader);\n\tgl.linkProgram(renderProgram);\n\n\tconst vertices = Array(\n\t\t-1, -1,\n\t\t-1, 1,\n\t\t1, 1,\n\t\t1, -1);\n\tconst indices = Array(0, 1, 2, 0, 2, 3);\n\n\tconst vertexBuffer = gl.createBuffer();\n\tgl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n\n\tconst indexBuffer = gl.createBuffer();\n\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\n\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\n\n\tgl.useProgram(program);\n\n\tconst resolution = gl.getUniformLocation(program, \"resolution\");\n\tgl.uniform2f(resolution, options.width, options.height);\n\n\tconst position = gl.getAttribLocation(program, \"position\");\n\tgl.enableVertexAttribArray(position);\n\tgl.vertexAttribPointer(position, 2, gl.FLOAT, false, 0, 0);\n\n\tgl.viewport(0, 0, options.width, options.height);\n\n\tlet odd = false;\n\n\treturn {\n\t\trender: function () {\n\t\t\tconst read = textures[odd ? 0 : 1];\n\t\t\tconst write = textures[odd ? 1 : 0];\n\n\t\t\tconst variables_ = Object.assign({\n\t\t\t\ttime: 0,\n\t\t\t\tclicked: false,\n\t\t\t\tmouse: { x: 0, y: 0 }\n\t\t\t}, variables || {});\n\n\t\t\tgl.useProgram(program);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, read);\n\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\t\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, write, 0);\n\t\t\tgl.uniform1f(gl.getUniformLocation(program, \"time\"), variables_.time);\n\t\t\tgl.uniform2f(gl.getUniformLocation(program, \"mouse\"), variables_.mouse.x, variables_.mouse.y);\n\t\t\tgl.uniform1i(gl.getUniformLocation(program, \"clicked\"), variables_.clicked ? 1 : 0);\n\t\t\tgl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n\n\t\t\tgl.useProgram(renderProgram);\n\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, write);\n\t\t\tgl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);\n\n\t\t\todd = !odd;\n\t\t}\n\t};\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/renderer.ts","import { Camera, orbit } from './camera';\nimport { value } from './expression';\nimport { Material, material } from './material';\nimport { Model } from './model';\n\nexport interface Scene {\n\treadonly models: Model[];\n\treadonly camera: Camera;\n\treadonly air: Material;\n}\n\nexport function scene(values?: {\n\tmodels?: Model[],\n\tcamera?: Camera,\n\tair?: Material\n}): Scene {\n\treturn Object.assign({\n\t\tmodels: [],\n\t\tcamera: orbit(),\n\t\tair: material({\n\t\t\trefraction: value(1)\n\t\t})\n\t}, values || {});\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/scene.ts","import { Options, options as _options } from './options';\nimport { createRenderer } from './renderer';\nimport { Scene } from './scene';\n\nexport function createViewer(\n\telement: HTMLElement,\n\tscene: Scene,\n\toptions?: Options) {\n\n\toptions = options || _options();\n\n\tconst canvas = document.createElement(\"canvas\");\n\tcanvas.width = options.width;\n\tcanvas.height = options.height;\n\telement.appendChild(canvas);\n\n\tconst gl = canvas.getContext(\"webgl\", {\n\t\tpreserveDrawingBuffer: false\n\t});\n\tif (gl === null)\n\t\treturn null;\n\n\tconst variables = {\n\t\ttime: 0,\n\t\tclicked: false,\n\t\tmouse: { x: 0.0, y: 0.0 }\n\t};\n\n\tconst renderer = createRenderer(gl, scene, options, variables);\n\n\tcanvas.addEventListener(\"mousedown\", () => variables.clicked = true);\n\tdocument.addEventListener(\"mouseup\", () => variables.clicked = false);\n\n\tcanvas.addEventListener(\"mousemove\", event => {\n\t\tif (variables.clicked) {\n\t\t\tvariables.mouse.x += event.movementX / canvas.clientWidth;\n\t\t\tvariables.mouse.y += -event.movementY / canvas.clientHeight;\n\t\t}\n\t});\n\n\tlet start = 0;\n\n\tfunction loop(time: number) {\n\t\tif (!start) start = time;\n\t\tvariables.time = (time - start) / 1000.0;\n\n\t\trenderer.render();\n\n\t\trequestAnimationFrame(loop);\n\t}\n\n\trequestAnimationFrame(loop);\n}\n\n\n// WEBPACK FOOTER //\n// ../rayity/src/viewer.ts","import {\n\tcamera,\n\tcreateViewer,\n\tdodecahedron,\n\tmaterial,\n\tmodel,\n\toptions,\n\torbit,\n\tplane,\n\tscale,\n\tscene,\n\tsphere,\n\tspotlight,\n\tvalue,\n} from 'rayity';\n\n\ncreateViewer(\n\tdocument.body,\n\tscene({\n\t\tair: material({\n\t\t\tscatter: value(1000),\n\t\t}),\n\t\tcamera: orbit({\n\t\t\tfieldOfView: value(60 / 180 * Math.PI),\n\t\t\tdistance: value(2),\n\t\t\taperture: value(0.1),\n\t\t\ttarget: value(0),\n\t\t\toffset: value(0.25, -0.5)\n\t\t}),\n\t\tmodels: [\n\t\t\tmodel({\n\t\t\t\tshape: scale(value(1000),\n\t\t\t\t\tsphere()),\n\t\t\t\tmaterial: spotlight({\n\t\t\t\t\tcolor: value(1),\n\t\t\t\t\tdirection: value(1, 1, 1),\n\t\t\t\t\tspread: value(0.05),\n\t\t\t\t\tambient: value(0)\n\t\t\t\t})\n\t\t\t}),\n\t\t\tmodel({\n\t\t\t\tshape: plane(value(0, 1, 0), value(0.5)),\n\t\t\t\tmaterial: material({\n\t\t\t\t\tcolor: value(0.5)\n\t\t\t\t})\n\t\t\t}),\n\t\t\tmodel({\n\t\t\t\tshape: dodecahedron(),\n\t\t\t\tmaterial: material({\n\t\t\t\t\tcolor: value(0.7, 0.6, 0.5)\n\t\t\t\t})\n\t\t\t})\n\t\t]\n\t}), options({\n\t\twidth: 512,\n\t\theight: 512,\n\t\tepsilon: 1e-4,\n\t\tsteps: 100,\n\t\tbounces: 5,\n\t\titerations: 1,\n\t\tcheapNormals: true,\n\t\tmemory: 1\n\t}));\n\n\n\n\n// WEBPACK FOOTER //\n// ./index.ts"],"sourceRoot":""}